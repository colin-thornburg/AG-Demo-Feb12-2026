version: 2

sources:
  - name: raw_acq
    database: AG_DEMO
    schema: RAW_ACQ
    description: >
      Raw data export from acquired entity: AssuredPartners Southeast Region.
      Loaded as-is — no transformations applied.
      Known issues: inconsistent code values, potential duplicates,
      null names/fields, late-arriving updates, orphaned foreign keys.
    tables:
      - name: raw_claim
        description: "Raw AssuredPartners Southeast Region — raw claim table"
        columns:
          - name: claim_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null
              - unique
          - name: source_system
            description: "Raw field — review for business meaning"
          - name: acq_entity
            description: "Raw field — review for business meaning"
          - name: claim_status
            description: "Code/status value (may need normalization)"
          - name: incurred_amount
            description: "Monetary amount (raw, unvalidated)"
          - name: policy_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn
                  arguments:
                    to: source('raw_acq', 'raw_policy')
                    field: policy_id
          - name: loss_date
            description: "Timestamp field"
          - name: updated_at
            description: "Timestamp field"
          - name: reported_date
            description: "Timestamp field"
          - name: paid_amount
            description: "Monetary amount (raw, unvalidated)"

      - name: raw_claim_txn
        description: "Raw AssuredPartners Southeast Region — raw claim transaction table"
        columns:
          - name: claim_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn
                  arguments:
                    to: source('raw_acq', 'raw_claim')
                    field: claim_id
          - name: acq_entity
            description: "Raw field — review for business meaning"
          - name: txn_type
            description: "Code/status value (may need normalization)"
          - name: updated_at
            description: "Timestamp field"
          - name: source_system
            description: "Raw field — review for business meaning"
          - name: txn_date
            description: "Timestamp field"
          - name: txn_amount
            description: "Monetary amount (raw, unvalidated)"
          - name: claim_txn_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null
              - unique

      - name: raw_customer
        description: "Raw AssuredPartners Southeast Region — raw customer table"
        columns:
          - name: customer_name
            description: "Name field (may contain nulls in acquired data)"
          - name: source_system
            description: "Raw field — review for business meaning"
          - name: created_at
            description: "Timestamp field"
          - name: customer_type
            description: "Code/status value (may need normalization)"
          - name: acq_entity
            description: "Raw field — review for business meaning"
          - name: customer_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null
              - unique
          - name: updated_at
            description: "Timestamp field"
          - name: state
            description: "Raw field — review for business meaning"

      - name: raw_policy
        description: "Raw AssuredPartners Southeast Region — raw policy table"
        columns:
          - name: expiration_date
            description: "Timestamp field"
          - name: acq_entity
            description: "Raw field — review for business meaning"
          - name: policy_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null
              - unique
          - name: updated_at
            description: "Timestamp field"
          - name: written_premium
            description: "Monetary amount (raw, unvalidated)"
          - name: policy_status
            description: "Code/status value (may need normalization)"
          - name: policy_number
            description: "Raw field — review for business meaning"
          - name: customer_id
            description: "Primary/foreign key identifier"
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn
                  arguments:
                    to: source('raw_acq', 'raw_customer')
                    field: customer_id
          - name: source_system
            description: "Raw field — review for business meaning"
          - name: carrier
            description: "Raw field — review for business meaning"
          - name: effective_date
            description: "Timestamp field"
          - name: line_of_business
            description: "Raw field — review for business meaning"
