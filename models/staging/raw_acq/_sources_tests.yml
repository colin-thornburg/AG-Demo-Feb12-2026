version: 2

sources:
  - name: raw_acq
    tables:
      - name: raw_claim
        columns:
          - name: claim_id
            tests:
              - not_null
              - unique
          - name: policy_id
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn

                  arguments:
                    to: source('raw_acq', 'raw_policy')
                    field: policy_id
      - name: raw_claim_txn
        columns:
          - name: claim_txn_id
            tests:
              - not_null
              - unique
          - name: claim_id
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn

                  arguments:
                    to: source('raw_acq', 'raw_claim')
                    field: claim_id
      - name: raw_customer
        columns:
          - name: customer_id
            tests:
              - not_null
              - unique

      - name: raw_policy
        columns:
          - name: policy_id
            tests:
              - not_null
              - unique
          - name: customer_id
            tests:
              - not_null:
                  config:
                    severity: warn
              - relationships:
                  config:
                    severity: warn
                  arguments:
                    to: source('raw_acq', 'raw_customer')
                    field: customer_id